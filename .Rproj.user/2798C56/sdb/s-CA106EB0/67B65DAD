{
    "contents" : "# Models and ML Algorithms\n\nsummary(orders.train)\n\n#----------------------#\n#  Logistic Regression #\n#----------------------#\n# Look at Week 3 assignment of Predict 412\n\n# LR \"Full Model\"\nreturns.lr <- glm(returnShipment ~ color + timeToDeliver + accountAge \n                  + customerAge + holidayFlag + bdayFlag + numItemsInOrder\n                  + manufRiskFlag + itemRiskFlag,\n              family=binomial(link=logit), data=orders.train)\nsummary(returns.lr)\n\n# Backwards elimination selection\n# use default AIC measure\n# eliminates variables X1 and X2....  \n# Note step function uses full model defined above \nreturns.backward <- step(returns.lr)\nsummary(returns.backward)\n\n\n# TO Get ROC Curves\n# get predictions from model \n# NEED TO KNOW WHAT WE CALL TRAIN AND TEST DATA SETS\npredict.train.logistic <- predict(returns.lr, orders.train, type=\"response\")\npredict.test.logistic <- predict(returns.lr, orders.test, type=\"response\")\n\ntrain.logistic.pred <- prediction(predict.train.logistic, orders.train$returnShipment)\ntrain.logistic.roc <- performance(train.logistic.pred, \"tpr\",\"fpr\")\ntrain.logistic.auc <- (performance(train.logistic.pred, \"auc\"))@y.values\n\ntest.logistic.pred <- prediction(predict.test.logistic, test$returnShipment)\ntest.logistic.roc <- performance(test.logistic.pred, \"tpr\",\"fpr\")\ntest.logistic.auc <- (performance(test.logistic.pred, \"auc\"))@y.values\n\n# plot the full model ROC curves\npdf(file = \"full_model_ROC.pdf\", width = 11, height = 8.5)  ##/\\open pdf/\\##\nplot(train.logistic.roc, col = \"darkgreen\", main = \"ROC Curves for Logistic Regression Model\")\nplot(test.logistic.roc, col = \"red\",  add = TRUE)\nabline(c(0,1))\n# Draw a legend.\ntrain.legend <- paste(\"Train: AUC=\", round(train.logistic.auc[[1]], digits=3))\ntest.legend <- paste(\"Test : AUC=\", round(test.logistic.auc[[1]], digits=3))\nlegend(0.6, 0.5, c(train.legend,test.legend), c(3,2))\n\n\n#------------------#\n# Confusion Matrix #  \n#------------------#\n# We need to convert preds to actual choice; introduce 'cut'\n# selected a p=.65 cutoff after review of ROC\npredictions<-cut(rpredict.test.logistic, c(-Inf,0.65,Inf), labels=c(\"ATT\",\"OCC\"))\n# Now have a look - classes are assigned\nstr(predictions)\nsummary(predictions)\n# compare to test$pick to ensure same # of levels and obs\nstr(test$pick)\nsummary(test$pick)\n\nconfusionMatrix(predictions, test$pick)\n\n\n\n#------------------#\n#  Decision Trees  #\n#------------------#\n# J48 (based on Quinlan's C4.5)\nlibrary(RWeka)\n# to run j48 in RWeka\n# Get an error that j48 cannot handle numeric class - do we have to convert to something else for this to work?\nreturns_j48 <- J48(returnShipment ~ color + timeToDeliver + accountAge \n                     + customerAge + holidayFlag + bdayFlag + numItemsInOrder\n                     + manufRiskFlag + itemRiskFlag\n                     , data = orders.train)\nreturns_j48\nsummary(returns_j48)\n\n\n#--------------------#\n#   Random Forests   #\n#--------------------#\n# Get strange error message \n\nlibrary(randomForest)\nfit <- randomForest(returnShipment ~ color + timeToDeliver + accountAge \n                    + customerAge + holidayFlag + bdayFlag + numItemsInOrder\n                    + manufRiskFlag + itemRiskFlag\n                      , data = orders.train)\nprint(fit) # view results\nimportance(fit) # importance of each predictor \n# we note variable x1 is most important, followed by x2, x3, and x4\n\nRFprediction <- predict(fit, test)\nconfusionMatrix(RFprediction, test$pick)\n\n#-----------------------------#\n#   Support Vector Machines   #\n#-----------------------------#\n\n\n\n# Ensemble Methods\n# Perhaps can average prediction from some of above",
    "created" : 1398221759982.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1634625313",
    "id" : "67B65DAD",
    "lastKnownWriteTime" : 1398229258,
    "path" : "~/GitHub/CAPSTONE/Modeling Code.R",
    "project_path" : "Modeling Code.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}